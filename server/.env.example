# Forever Fields Backend - Environment Variables
# Copy this file to .env and fill in your actual values

# ============================================
# SERVER CONFIGURATION
# ============================================
NODE_ENV=development
PORT=3000
API_URL=http://localhost:3000
FRONTEND_URL=http://localhost:5173

# ============================================
# DATABASE (PostgreSQL via Supabase)
# ============================================
# Get from: https://app.supabase.com/project/_/settings/database
#
# IMPORTANT: You need TWO connection strings for Prisma + Supabase pooling:
#
# 1. DATABASE_URL - Transaction Pooler (Port 6543) for Prisma Client queries
#    - Must include ?pgbouncer=true&connection_limit=1
#    - Format: postgresql://postgres.[PROJECT_REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=1
#
# 2. DIRECT_URL - Direct Connection (Port 5432) for Prisma migrations
#    - Format: postgresql://postgres.[PROJECT_REF]:[PASSWORD]@db.[PROJECT_REF].supabase.com:5432/postgres
#
# Why both? Supabase uses Supavisor pooling. Prisma needs pooled connection for queries
# and direct connection for schema operations. See: https://supabase.com/docs/guides/database/prisma
#
DATABASE_URL=postgresql://postgres.YOUR_PROJECT_REF:YOUR_PASSWORD@aws-0-us-east-1.pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=1
DIRECT_URL=postgresql://postgres.YOUR_PROJECT_REF:YOUR_PASSWORD@db.YOUR_PROJECT_REF.supabase.co:5432/postgres

# ============================================
# SUPABASE (Auth & Database)
# ============================================
# Get these from: https://app.supabase.com/project/_/settings/api
SUPABASE_URL=https://YOUR_PROJECT.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ============================================
# CLOUDINARY (File Uploads)
# ============================================
# Get these from: https://cloudinary.com/console
# Sign up at: https://cloudinary.com/users/register/free
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=123456789012345
CLOUDINARY_API_SECRET=your_api_secret_here

# ============================================
# EMAIL (SMTP via Resend)
# ============================================
# Get API key from: https://resend.com/api-keys
# Sign up at: https://resend.com/signup
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=resend
SMTP_PASS=re_YourResendApiKey
SMTP_FROM=Forever Fields <noreply@foreverfields.app>

# ============================================
# WEB PUSH NOTIFICATIONS (Optional)
# ============================================
# Generate VAPID keys with: npx web-push generate-vapid-keys
# Leave blank to disable push notifications
VAPID_PUBLIC_KEY=BAbcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890
VAPID_PRIVATE_KEY=abcdefghijklmnopqrstuvwxyz1234567890ABCDEFG
VAPID_SUBJECT=mailto:admin@foreverfields.com

# ============================================
# SECURITY
# ============================================
# Generate secure JWT secret with: openssl rand -base64 64
# ⚠️ NEVER commit this to version control
# ⚠️ Use a different secret for production
JWT_SECRET=YOUR_SECURE_RANDOM_STRING_MIN_64_CHARACTERS_LONG_GENERATED_WITH_OPENSSL

# ============================================
# AFFILIATE PARTNERSHIPS (Optional)
# ============================================
# BloomNation flower delivery affiliate
# Sign up at: https://www.bloomnation.com/affiliates
# Leave blank to use default fallback
BLOOMNATION_AFFILIATE_ID=your_affiliate_id_here

# ============================================
# PAYMENT PROCESSING (Optional - Future Feature)
# ============================================
# Stripe for subscription payments
# Get from: https://dashboard.stripe.com/apikeys
# Sign up at: https://stripe.com/register
# Leave blank if not using subscriptions yet
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PRICE_ID_BASIC=price_...
STRIPE_PRICE_ID_PREMIUM=price_...

# ============================================
# GOOGLE MAPS (Optional - Future Feature)
# ============================================
# For burial location maps feature
# Get from: https://console.cloud.google.com/apis/credentials
# Sign up at: https://console.cloud.google.com/
# Leave blank if not using maps yet
GOOGLE_MAPS_API_KEY=AIzaSy...

# ============================================
# ERROR TRACKING (Optional - Recommended for Production)
# ============================================
# Sentry for error monitoring
# Sign up at: https://sentry.io/signup/
# Leave blank to disable error tracking
SENTRY_DSN=https://...@sentry.io/...

# ============================================
# NOTES FOR DEVELOPERS
# ============================================
#
# CREDENTIAL SETUP CHECKLIST:
# ✅ 1. Copy this file to .env: cp .env.example .env
# ✅ 2. Create Supabase project: https://supabase.com/dashboard/new
# ✅ 3. Run Prisma migrations: npm run prisma:migrate
# ✅ 4. Generate Prisma client: npm run prisma:generate
# ✅ 5. Create Cloudinary account: https://cloudinary.com/users/register/free
# ✅ 6. Create Resend account: https://resend.com/signup
# ✅ 7. Generate VAPID keys: npx web-push generate-vapid-keys
# ✅ 8. Generate JWT secret: openssl rand -base64 64
# ✅ 9. Update .env with your actual credentials
# ✅ 10. NEVER commit .env to version control
#
# SECURITY REMINDERS:
# ⚠️ Rotate JWT_SECRET and database password before production
# ⚠️ Use different credentials for staging/production
# ⚠️ Enable 2FA on all service accounts (Supabase, Cloudinary, etc.)
# ⚠️ Regularly rotate API keys (quarterly recommended)
# ⚠️ Monitor API usage for suspicious activity
#
# PRODUCTION CONFIGURATION:
# For production deployment (Render.com):
# 1. Set NODE_ENV=production
# 2. Update FRONTEND_URL to https://forever-fields.pages.dev
# 3. Update API_URL to https://forever-fields.onrender.com
# 4. Set both DATABASE_URL (pooler) and DIRECT_URL (direct) in Render's environment variables
#    - Get pooler connection from Supabase: Project Settings > Database > Connection Pooling
#    - DATABASE_URL must use port 6543 with ?pgbouncer=true&connection_limit=1
#    - DIRECT_URL must use port 5432 without query parameters
# 5. Use Render's environment variables UI (not .env file)
# 6. Enable HTTPS-only in Render settings
#
# SUPPORT:
# Questions? Contact: support@foreverfields.com
# Documentation: https://github.com/your-repo/docs
